window.searchIndex = {"fields":["title","body"],"pipeline":["trimmer","stopWordFilter","stemmer"],"ref":"id","version":"0.9.5","index":{"body":{"root":{"docs":{},"df":0,"a":{"docs":{},"df":0,"s":{"docs":{},"df":0,"y":{"docs":{},"df":0,"n":{"docs":{},"df":0,"c":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}},"c":{"docs":{},"df":0,"a":{"docs":{},"df":0,"l":{"docs":{},"df":0,"l":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}},"r":{"docs":{},"df":0,"o":{"docs":{},"df":0,"n":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}},"f":{"docs":{},"df":0,"l":{"docs":{},"df":0,"u":{"docs":{},"df":0,"s":{"docs":{},"df":0,"h":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}},"r":{"docs":{},"df":0,"o":{"docs":{},"df":0,"m":{"docs":{},"df":0,"a":{"docs":{},"df":0,"t":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}}},"j":{"docs":{},"df":0,"s":{"docs":{},"df":0,"o":{"docs":{},"df":0,"n":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}},"k":{"docs":{},"df":0,"e":{"docs":{},"df":0,"r":{"docs":{},"df":0,"n":{"docs":{},"df":0,"e":{"docs":{},"df":0,"l":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}},"u":{"docs":{},"df":0,"b":{"docs":{},"df":0,"e":{"docs":{},"df":0,"r":{"docs":{},"df":0,"n":{"docs":{},"df":0,"e":{"docs":{},"df":0,"t":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}}}}},"l":{"docs":{},"df":0,"a":{"docs":{},"df":0,"t":{"docs":{},"df":0,"a":{"docs":{},"df":0,"n":{"docs":{},"df":0,"c":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}},"o":{"docs":{},"df":0,"g":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":2.6457513110645907}},"df":1}}},"p":{"docs":{},"df":0,"i":{"docs":{},"df":0,"p":{"docs":{},"df":0,"e":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}},"o":{"docs":{},"df":0,"s":{"docs":{},"df":0,"t":{"docs":{"https://gitrus.github.io/posts/":{"tf":1.0}},"df":1}}}},"s":{"docs":{},"df":0,"e":{"docs":{},"df":0,"n":{"docs":{},"df":0,"t":{"docs":{},"df":0,"r":{"docs":{},"df":0,"i":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}},"t":{"docs":{},"df":0,"d":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.4142135623730951}},"df":1,"o":{"docs":{},"df":0,"u":{"docs":{},"df":0,"t":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1,"/":{"docs":{},"df":0,"s":{"docs":{},"df":0,"t":{"docs":{},"df":0,"d":{"docs":{},"df":0,"e":{"docs":{},"df":0,"r":{"docs":{},"df":0,"r":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}}}}}}}}},"y":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1,"n":{"docs":{},"df":0,"c":{"docs":{},"df":0,"/":{"docs":{},"df":0,"a":{"docs":{},"df":0,"s":{"docs":{},"df":0,"y":{"docs":{},"df":0,"n":{"docs":{},"df":0,"c":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}}}}}}}}},"title":{"root":{"docs":{},"df":0,"l":{"docs":{},"df":0,"o":{"docs":{},"df":0,"g":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}},"p":{"docs":{},"df":0,"o":{"docs":{},"df":0,"s":{"docs":{},"df":0,"t":{"docs":{"https://gitrus.github.io/posts/":{"tf":1.0}},"df":1}}}},"s":{"docs":{},"df":0,"y":{"docs":{},"df":0,"n":{"docs":{},"df":0,"c":{"docs":{},"df":0,"/":{"docs":{},"df":0,"a":{"docs":{},"df":0,"s":{"docs":{},"df":0,"y":{"docs":{},"df":0,"n":{"docs":{},"df":0,"c":{"docs":{"https://gitrus.github.io/posts/sync-logging/":{"tf":1.0}},"df":1}}}}}}}}}}}}},"documentStore":{"save":true,"docs":{"https://gitrus.github.io/":{"body":"","id":"https://gitrus.github.io/","title":""},"https://gitrus.github.io/posts/":{"body":"","id":"https://gitrus.github.io/posts/","title":"Posts"},"https://gitrus.github.io/posts/sync-logging/":{"body":"Понятие logging\nВ этой заметке log - текст, который передается в стандартные потоки вывода процесса: stdout/stderr\nЗапись может быть fromat-ированной и в виде json (мета). \nВ микросервисном мире с kubernetes, из-за невозможности попасть на все поды разом, log-и используются как инструмент общения с кодом.\nAsync logging?\nЗапись в stdout == блокирующая запись в pipe, то есть в буффер на стороне Kernel-а.\nПоэтому есть библиотеки, которые позволяют писать логи без блокировки. То есть между вызовом метода log и попаданием текста в std* есть программный буффер, \nкоторый лишь раз в х секунд флашится (flush=запись + очистка) в std*. Это уменьшает latancy из-за более редкого вызова sys-call-а. \nБуффер дает пойти ещё дальше: семплировать логи по ключам. То есть отбрасывать похожие логи, для того чтобы не записывать одинаковые строки.\nЗачем нужен logging?\nДля того, чтобы понять возможность использования подобных библиотек, вернемся к тому для чего используются логи:\n\nдля дебага или отложенного дебага. Для этого нам важно построить трейс того, что происходило в коде до ошибки и залогировать саму ошибку.\nНо если при этом происходит краш, то при использовании асинхронных логов буффер логов не флешнется, потому что код уже упал.\nПолучаем ситуацию, в которой проблема прозошла, а логов о проблеме нет. Поэтому дебаг-логи и ошибки должны быть синхронным, как пример sentry\nдля проверки факта запуска или результатов запуска. То есть: посмотреть пользуются ли ручкой и какие параметры передают. Или отработала ли cron-джоба. Здесь логер мог бы быть асинхронным.\nНо с другой стороны зачем здесь логер? Кажется, гораздо больше для этой задачи подходят метрики.\nЛогер будет подходить, только если нужны параметры. Здесь выбор сводится к необходимой точности: можем ли мы потерять часть параметров или семплировать их.\nкак мусорка. Это самое частое использование логов. В этом сценарии не ясно зачем вообще что-то логировать.\n\nИтого\nТам где логи нужны, там часто важна синхронность записи, чтобы эти записи не потерять. А там где нет -- в целом без разницы.\n","id":"https://gitrus.github.io/posts/sync-logging/","title":"Sync/Async Logging"}},"docInfo":{"https://gitrus.github.io/":{"body":0,"title":0},"https://gitrus.github.io/posts/":{"body":0,"title":1},"https://gitrus.github.io/posts/sync-logging/":{"body":22,"title":2}},"length":3},"lang":"English"};